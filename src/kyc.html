<!DOCTYPE html>
<html lang="en">
<head>
	<title>KYC | Crafthost</title>
	@@include('./include/head.html')
</head>

<body class="kyc__body">
	<div class="wrapper">
		@@include('./include/icon-sprite.html')
		<header class="header__top">
			<div class="container-xl">
				<div class="kyc__logo">
					<img srcset="img/header/logo.png, img/header/logo-2x.png 2x" src="img/login/logo-inverted.png" alt="logo" width="135" height="32">
				</div>
				<a href="signin.html" class="btn btn--lg btn--outlined">Log in</a>
			</div>
		</header>
		<main class="kyc__main container">
			<h1 class="h1">KYC</h1>

			<form id="verify-form" class="kyc__grid">
				<div class="upload__item upload__item--kyc">
					<div class="upload__text">
						<div class="upload__step">STEP 1</div>
						<h3 class="h3">Upload government ID</h3>
						<p>Take a picture of or scan your ID or passport.<br>Make sure the next is cleanly visible</p>
					</div>
					<div class="upload__dropzone">
						<figure class="upload__picture">
							<img srcset="img/profile/info/info-1.png, img/profile/info/info-1-2x.png 2x" src="img/profile/info/info-1.png" alt="user">
						</figure>
						<div>
							<h4 class="h4">Drag file here to upload</h4>
							<p>Formats: JPG, PNG, PDF</p>
						</div>
						<div class="upload__cta">
							<input type="file" name="file" id="file" data-multiple-caption="{count} files" accept="image/jpeg,image/png,image/jpg">
							<label class="file__area" for="file">
								<i class="i-file"><svg viewBox="0 0 32 32"><use xlink:href="#i-link" /></svg></i>
								<span data-text="Upload image">Upload image</span>
							</label>
						</div>
					</div>
				</div>
				<div class="upload__item upload__item--kyc">
					<div class="upload__text">
						<div class="upload__step">STEP 2</div>
						<h3 class="h3">Upload selfie with ID</h3>
						<p>Take a picture or yourself holding your ID or passport.<br>The ID or passport should be the same that you are using for ID verification</p>
					</div>
					<div class="upload__dropzone">
						<figure class="upload__picture">
							<img srcset="img/profile/info/info-2.png, img/profile/info/info-2-2x.png 2x" src="img/profile/info/info-2.png" alt="app">
						</figure>
						<div>
							<h4 class="h4">Drag file here to upload</h4>
							<p>Formats: JPG, PNG, PDF</p>
						</div>
						<div class="upload__cta">
							<input type="file" name="file2" id="file2" data-multiple-caption="{count} files" accept="image/jpeg,image/png,image/jpg">
							<label class="file__area" for="file2">
								<i class="i-file"><svg viewBox="0 0 32 32"><use xlink:href="#i-link" /></svg></i>
								<span data-text="Upload image">Upload image</span>
							</label>
						</div>
					</div>
				</div>
				<div class="text-center">
					<button type="submit" class="btn btn--lg btn--success btn--icon">Submit</button>
					<button data-temp="error" type="button" class="btn btn--lg btn--danger btn--icon" data-drawer-trigger aria-controls="error-modal" aria-expanded="false" aria-label="Alert">Error</button>
					<button data-temp="success" type="button" class="btn btn--lg btn--success btn--icon" data-drawer-trigger aria-controls="success-modal" aria-expanded="false" aria-label="Alert">Success</button>
				</div>
			</form>
		</main>
	</div>

	<!-- success modal-->
	<div class="drawer drawer--alert" id="success-modal" data-drawer-target>
		<div class="drawer__overlay" data-drawer-close tabindex="-1"></div>
		<div class="drawer__alert">
			<div class="drawer__fieldset">
				@@include('./pages/modal-success-loading.html')
			</div>
		</div>
	</div>

	<!-- error modal-->
	<div class="drawer drawer--alert" id="error-modal" data-drawer-target>
		<div class="drawer__overlay" data-drawer-close tabindex="-1"></div>
		<div class="drawer__alert">
			<div class="drawer__fieldset">
				@@include('./pages/modal-error-loading.html')
			</div>
		</div>
	</div>

	<script src="js/drawer.js"></script>
	<script src="js/main.js"></script>
	<script>

		var loaded = false;

		// drag and drop Dropzones
		(function () {
			const droprzones = document.querySelectorAll('.upload__dropzone');
			[...droprzones].forEach(function (zone) {
				zone.addEventListener('ondrag ondragenter', function (e) {
					e.preventDefault();
					e.stopPropagation();
				});

				zone.ondragover = function (e) {
					e.preventDefault();
					zone.classList.add('upload__dropzone--active');
				};

				zone.ondragleave = function (e) {
					e.preventDefault();
					zone.classList.remove('upload__dropzone--active');
				};

				zone.ondrop = function (e) {
					e.preventDefault();
					let label = zone.querySelector('.file__area');
						fileName = '',
						droppedFiles = null,
						fileInput = zone.querySelector('input[type=file]');

						droppedFiles = e.dataTransfer.files;
						fileName = droppedFiles[0]['name'];
						label.querySelector('span').innerHTML = fileName.split('\\').pop();

					zone.classList.remove('upload__dropzone--active');
					zone.classList.add('upload__dropzone--loaded');
					loaded = true;
				};
			});


			//change file inputs
			const inputs = document.querySelectorAll('[type=file]');
			[...inputs].forEach( function (input) {
				input.addEventListener('change', function (e) {
					let label = e.target.nextElementSibling,
						 labelVal = label.innerHTML,
						 fileName = '';
					if (this.files && this.files.length > 1){
						fileName = (this.getAttribute('data-multiple-caption') || 'no files selected').replace('{count}', this.files.length);
					}
					else {
						fileName = e.target.value.split('\\').pop();
					}
					if (fileName) {
						label.querySelector('span').innerHTML = fileName;
						label.closest('.upload__dropzone').classList.add('upload__dropzone--loaded');
						loaded = true;
					}
					else label.innerHTML = labelVal;
				});
			});
		}());

		// temp solution (trigger show message)
		const formFactor = document.getElementById('verify-form');
		formFactor?.addEventListener('submit', function (e) {
			e.preventDefault();
			const successBtn = document.querySelector('[data-temp=success]');
			const errorBtn = document.querySelector('[data-temp=error]');
			if (loaded) {
				successBtn.click();
			} else {
				errorBtn.click();
			}
		});
	</script>
</body>
</html>